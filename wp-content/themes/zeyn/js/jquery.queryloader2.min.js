!function(t){function e(t){this.parent=t,this.container,this.loadbar,this.percentageContainer}function n(t){this.toPreload=[],this.parent=t,this.container}function i(t){this.element,this.parent=t}function o(i,o){this.element=i,this.$element=t(i),this.options=o,this.foundUrls=[],this.destroyed=!1,this.imageCounter=0,this.imageDone=0,this.alreadyLoaded=!1,this.timerStart=Date.now(),this.preloadContainer=new n(this),this.overlayLoader=new e(this),this.defaultOptions={onComplete:function(){},onLoadComplete:function(){},backgroundColor:"#000",barColor:"#fff",overlayId:"qLoverlay",barHeight:1,percentage:!1,deepSearch:!0,completeAnimation:"fade",timeOutTime:6e4,minimumTime:500},this.init()}!function(t){"use strict";function e(e){var n=t.event;return n.target=n.target||n.srcElement||e,n}var n=document.documentElement,i=function(){};n.addEventListener?i=function(t,e,n){t.addEventListener(e,n,!1)}:n.attachEvent&&(i=function(t,n,i){t[n+i]=i.handleEvent?function(){var n=e(t);i.handleEvent.call(i,n)}:function(){var n=e(t);i.call(t,n)},t.attachEvent("on"+n,t[n+i])});var o=function(){};n.removeEventListener?o=function(t,e,n){t.removeEventListener(e,n,!1)}:n.detachEvent&&(o=function(t,e,n){t.detachEvent("on"+e,t[e+n]);try{delete t[e+n]}catch(i){t[e+n]=void 0}});var r={bind:i,unbind:o};"function"==typeof define&&define.amd?define(r):"object"==typeof exports?module.exports=r:t.eventie=r}(this),function(){"use strict";function t(){}function e(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function n(t){return function(){return this[t].apply(this,arguments)}}var i=t.prototype,o=this,r=o.EventEmitter;i.getListeners=function(t){var e,n,i=this._getEvents();if(t instanceof RegExp){e={};for(n in i)i.hasOwnProperty(n)&&t.test(n)&&(e[n]=i[n])}else e=i[t]||(i[t]=[]);return e},i.flattenListeners=function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push(t[e].listener);return n},i.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},i.addListener=function(t,n){var i,o=this.getListenersAsObject(t),r="object"==typeof n;for(i in o)o.hasOwnProperty(i)&&-1===e(o[i],n)&&o[i].push(r?n:{listener:n,once:!1});return this},i.on=n("addListener"),i.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},i.once=n("addOnceListener"),i.defineEvent=function(t){return this.getListeners(t),this},i.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},i.removeListener=function(t,n){var i,o,r=this.getListenersAsObject(t);for(o in r)r.hasOwnProperty(o)&&(i=e(r[o],n),-1!==i&&r[o].splice(i,1));return this},i.off=n("removeListener"),i.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},i.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},i.manipulateListeners=function(t,e,n){var i,o,r=t?this.removeListener:this.addListener,a=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(i=n.length;i--;)r.call(this,e,n[i]);else for(i in e)e.hasOwnProperty(i)&&(o=e[i])&&("function"==typeof o?r.call(this,i,o):a.call(this,i,o));return this},i.removeEvent=function(t){var e,n=typeof t,i=this._getEvents();if("string"===n)delete i[t];else if(t instanceof RegExp)for(e in i)i.hasOwnProperty(e)&&t.test(e)&&delete i[e];else delete this._events;return this},i.removeAllListeners=n("removeEvent"),i.emitEvent=function(t,e){var n,i,o,r,a=this.getListenersAsObject(t);for(o in a)if(a.hasOwnProperty(o))for(i=a[o].length;i--;)n=a[o][i],n.once===!0&&this.removeListener(t,n.listener),r=n.listener.apply(this,e||[]),r===this._getOnceReturnValue()&&this.removeListener(t,n.listener);return this},i.trigger=n("emitEvent"),i.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},i.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},i._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},i._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return o.EventEmitter=r,t},"function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.EventEmitter=t}.call(this),function(t,e){"use strict";"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(n,i){return e(t,n,i)}):"object"==typeof exports?module.exports=e(t,require("eventEmitter"),require("eventie")):t.imagesLoaded=e(t,t.EventEmitter,t.eventie)}(this,function(t,e,n){"use strict";function i(t,e){for(var n in e)t[n]=e[n];return t}function o(t){return"[object Array]"===u.call(t)}function r(t){var e=[];if(o(t))e=t;else if("number"==typeof t.length)for(var n=0,i=t.length;i>n;n++)e.push(t[n]);else e.push(t);return e}function a(t,e,n){if(!(this instanceof a))return new a(t,e);"string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=r(t),this.options=i({},this.options),"function"==typeof e?n=e:i(this.options,e),n&&this.on("always",n),this.getImages(),p&&(this.jqDeferred=new p.Deferred);var o=this;setTimeout(function(){o.check()})}function s(t){this.img=t}function h(t){this.src=t,f[t]=this}var p=t.jQuery,d=t.console,c="undefined"!=typeof d,u=Object.prototype.toString;a.prototype=new e,a.prototype.options={},a.prototype.getImages=function(){this.images=[];for(var t=0,e=this.elements.length;e>t;t++){var n=this.elements[t];"IMG"===n.nodeName&&this.addImage(n);for(var i=n.querySelectorAll("img"),o=0,r=i.length;r>o;o++){var a=i[o];this.addImage(a)}}},a.prototype.addImage=function(t){var e=new s(t);this.images.push(e)},a.prototype.check=function(){function t(t){return e.options.debug&&c,e.progress(t),n++,n===i&&e.complete(),!0}var e=this,n=0,i=this.images.length;if(this.hasAnyBroken=!1,!i)return this.complete(),void 0;for(var o=0;i>o;o++){var r=this.images[o];r.on("confirm",t),r.check()}},a.prototype.progress=function(t){this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded;var e=this;setTimeout(function(){e.emit("progress",e,t),e.jqDeferred&&e.jqDeferred.notify&&e.jqDeferred.notify(e,t)})},a.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var e=this;setTimeout(function(){if(e.emit(t,e),e.emit("always",e),e.jqDeferred){var n=e.hasAnyBroken?"reject":"resolve";e.jqDeferred[n](e)}})},p&&(p.fn.imagesLoaded=function(t,e){var n=new a(this,t,e);return n.jqDeferred.promise(p(this))}),s.prototype=new e,s.prototype.check=function(){var t=f[this.img.src]||new h(this.img.src);if(t.isConfirmed)return this.confirm(t.isLoaded,"cached was confirmed"),void 0;if(this.img.complete&&void 0!==this.img.naturalWidth)return this.confirm(0!==this.img.naturalWidth,"naturalWidth"),void 0;var e=this;t.on("confirm",function(t,n){return e.confirm(t.isLoaded,n),!0}),t.check()},s.prototype.confirm=function(t,e){this.isLoaded=t,this.emit("confirm",this,e)};var f={};return h.prototype=new e,h.prototype.check=function(){if(!this.isChecked){var t=new Image;n.bind(t,"load",this),n.bind(t,"error",this),t.src=this.src,this.isChecked=!0}},h.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},h.prototype.onload=function(t){this.confirm(!0,"onload"),this.unbindProxyEvents(t)},h.prototype.onerror=function(t){this.confirm(!1,"onerror"),this.unbindProxyEvents(t)},h.prototype.confirm=function(t,e){this.isConfirmed=!0,this.isLoaded=t,this.emit("confirm",this,e)},h.prototype.unbindProxyEvents=function(t){n.unbind(t.target,"load",this),n.unbind(t.target,"error",this)},a}),e.prototype.createOverlay=function(){var e="absolute";if("body"==this.parent.element.tagName.toLowerCase())e="fixed";else{var n=this.parent.$element.css("position");("fixed"!=n||"absolute"!=n)&&this.parent.$element.css("position","relative")}this.container=t("<div id='"+this.parent.options.overlayId+"'></div>").css({width:"100%",height:"100%",backgroundColor:this.parent.options.backgroundColor,backgroundPosition:"fixed",position:e,zIndex:666999,top:0,left:0}).appendTo(this.parent.$element),this.loadbar=t("<div id='qLbar'></div>").css({height:this.parent.options.barHeight+"px",marginTop:"-"+this.parent.options.barHeight/2+"px",backgroundColor:this.parent.options.barColor,width:"0%",position:"absolute",top:"50%"}).appendTo(this.container),1==this.parent.options.percentage&&(this.percentageContainer=t("<div id='qLpercentage'></div>").text("0%").css({height:"40px",width:"100px",position:"absolute",fontSize:"3em",top:"50%",left:"50%",marginTop:"-"+(59+this.parent.options.barHeight)+"px",textAlign:"center",marginLeft:"-50px",color:this.parent.options.barColor}).appendTo(this.container)),this.parent.preloadContainer.toPreload.length&&1!=this.parent.alreadyLoaded||(this.parent.overlayLoader.updatePercentage(100),this.parent.endLoader())},e.prototype.updatePercentage=function(t){this.loadbar.stop().animate({width:Math.ceil(t)+"%",minWidth:Math.ceil(t)+"%"},200),1==this.parent.options.percentage&&this.percentageContainer.text(Math.ceil(t)+"%")},n.prototype.create=function(){this.container=t("<div></div>").appendTo("body").css({display:"none",width:0,height:0,overflow:"hidden"}),this.processQueue()},n.prototype.processQueue=function(){for(var t=0;this.toPreload.length>t;t++)this.parent.destroyed||this.preloadImage(this.toPreload[t])},n.prototype.addImage=function(t){this.toPreload.push(t)},n.prototype.preloadImage=function(t){var e=new i;e.addToPreloader(this,t),e.bindLoadEvent()},i.prototype.addToPreloader=function(e,n){this.element=t("<img />").attr("src",n),this.element.appendTo(e.container),this.parent=e.parent},i.prototype.bindLoadEvent=function(){this.parent.imageCounter++,this.element[0].ref=this,new imagesLoaded(this.element,function(t){t.elements[0].ref.completeLoading()})},i.prototype.completeLoading=function(){this.parent.imageDone++;var t=100*(this.parent.imageDone/this.parent.imageCounter);this.parent.overlayLoader.updatePercentage(t),Date.now()-this.parent.timerStart>this.parent.options.timeOutTime&&this.parent.endLoader(),(this.parent.imageDone==this.parent.imageCounter||t>=100)&&this.parent.endLoader()},o.prototype.init=function(){if(this.options=t.extend({},this.defaultOptions,this.options),this.findImageInElement(this.element),1==this.options.deepSearch)for(var e=this.$element.find("*:not(script)"),n=0;n<e.length;n++)this.findImageInElement(e[n]);this.foundUrls.length,this.preloadContainer.create(),this.overlayLoader.createOverlay()},o.prototype.findImageInElement=function(e){var n="",o=t(e),r="normal";if("none"!=o.css("background-image")?(n=o.css("background-image"),r="background"):"undefined"!=typeof o.attr("src")&&"img"==e.nodeName.toLowerCase()&&(n=o.attr("src")),!this.hasGradient(n)){n=this.stripUrl(n);for(var a=n.split(", "),s=0;s<a.length;s++)if(this.validUrl(a[s])&&this.urlIsNew(a[s])){var h="";if(this.isIE()||this.isOpera())h="?rand="+Math.random(),this.preloadContainer.addImage(a[s]+h);else if("background"==r)this.preloadContainer.addImage(a[s]+h);else{var p=new i(this);p.element=o,p.bindLoadEvent()}this.foundUrls.push(a[s])}}},o.prototype.hasGradient=function(t){return-1==t.indexOf("gradient")?!1:!0},o.prototype.stripUrl=function(t){return t=t.replace(/url\(\"/g,""),t=t.replace(/url\(/g,""),t=t.replace(/\"\)/g,""),t=t.replace(/\)/g,"")},o.prototype.isIE=function(){return navigator.userAgent.match(/msie/i)},o.prototype.isOpera=function(){return navigator.userAgent.match(/Opera/i)},o.prototype.validUrl=function(t){return t.length>0&&!t.match(/^(data:)/i)?!0:!1},o.prototype.urlIsNew=function(t){return-1==this.foundUrls.indexOf(t)?!0:!1},o.prototype.destroyContainers=function(){this.destroyed=!0,this.preloadContainer.container.remove(),this.overlayLoader.container.remove()},o.prototype.endLoader=function(){this.destroyed=!0,this.onLoadComplete()},o.prototype.onLoadComplete=function(){if(this.options.onLoadComplete(),"grow"==this.options.completeAnimation){var e=this.options.minimumTime;this.overlayLoader.loadbar[0].parent=this,this.overlayLoader.loadbar.stop().animate({width:"100%"},e,function(){t(this).animate({top:"0%",width:"100%",height:"100%"},500,function(){this.parent.overlayLoader.container[0].parent=this.parent,this.parent.overlayLoader.container.fadeOut(500,function(){this.parent.destroyContainers(),this.parent.options.onComplete()})})})}else if("fromTop"==this.options.completeAnimation){var e=this.options.minimumTime;this.overlayLoader.loadbar[0].parent=this,this.overlayLoader.loadbar.stop().animate({width:"100%",top:0},e,function(){t(this).animate({width:"100%",height:"100%"},500,function(){this.parent.overlayLoader.container[0].parent=this.parent,this.parent.overlayLoader.container.fadeOut(500,function(){this.parent.destroyContainers(),this.parent.options.onComplete()})})})}else if("fromBottom"==this.options.completeAnimation){var e=this.options.minimumTime;this.overlayLoader.loadbar[0].parent=this,this.overlayLoader.loadbar.stop().animate({width:"100%",top:"100%"},e,function(){t(this).animate({top:0,width:"100%",height:"100%"},500,function(){this.parent.overlayLoader.container[0].parent=this.parent,this.parent.overlayLoader.container.fadeOut(500,function(){this.parent.destroyContainers(),this.parent.options.onComplete()})})})}else if("growHorizontal"==this.options.completeAnimation){var e=this.options.minimumTime;this.overlayLoader.loadbar[0].parent=this,this.overlayLoader.loadbar.stop().animate({height:"100%",top:0,left:"50%"},e,function(){t(this).animate({left:"0",width:"100%",height:"100%"},500,function(){this.parent.overlayLoader.container[0].parent=this.parent,this.parent.overlayLoader.container.fadeOut(500,function(){this.parent.destroyContainers(),this.parent.options.onComplete()})})})}else if("fromLeft"==this.options.completeAnimation){var e=this.options.minimumTime;this.overlayLoader.loadbar[0].parent=this,this.overlayLoader.loadbar.stop().animate({height:"100%",top:"0%"},e,function(){t(this).animate({width:"100%",height:"100%"},500,function(){this.parent.overlayLoader.container[0].parent=this.parent,this.parent.overlayLoader.container.fadeOut(500,function(){this.parent.destroyContainers(),this.parent.options.onComplete()})})})}else if("fromRight"==this.options.completeAnimation){var e=this.options.minimumTime;this.overlayLoader.loadbar[0].parent=this,this.overlayLoader.loadbar.stop().animate({height:"100%",top:"0%",left:"100%"},e,function(){t(this).animate({width:"100%",height:"100%",left:0},500,function(){this.parent.overlayLoader.container[0].parent=this.parent,this.parent.overlayLoader.container.fadeOut(500,function(){this.parent.destroyContainers(),this.parent.options.onComplete()})})})}else{var e=this.options.minimumTime;this.overlayLoader.container[0].parent=this,this.overlayLoader.container.fadeOut(e,function(){this.parent.destroyContainers(),this.parent.options.onComplete()})}},Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=e);e>n;n++)if(n in this&&this[n]===t)return n;return-1}),t.fn.queryLoader2=function(t){return this.each(function(){new o(this,t)})}}(jQuery);